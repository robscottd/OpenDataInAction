{
    "collab_server" : "",
    "contents" : "Sys.setenv(TZ=\"America/Montreal\")\nlibrary(rgdal)\nlibrary(ggplot2)\nlibrary(shinythemes)\nlibrary(leaflet)\nlibrary(plyr)\n#library(ggmap)\nlibrary(sp)\n\nload(\"OttawaCrime.RData\")\nshapeList<-list()\nshapeList[[1]] <- readOGR(dsn='./CrimeWards_SHP','CrimeWards_2005',verbose=FALSE,stringsAsFactors=FALSE)\nshapeList[[2]] <- readOGR(dsn='./CrimeWards_SHP','CrimeWards_2006',verbose=FALSE,stringsAsFactors=FALSE)\nshapeList[[3]] <- readOGR(dsn='./CrimeWards_SHP','CrimeWards_2006',verbose=FALSE,stringsAsFactors=FALSE)\nshapeList[[4]] <- readOGR(dsn='./CrimeWards_SHP','CrimeWards_2008',verbose=FALSE,stringsAsFactors=FALSE)\nshapeList[[5]] <- readOGR(dsn='./CrimeWards_SHP','CrimeWards_2009',verbose=FALSE,stringsAsFactors=FALSE)\nshapeList[[6]] <- readOGR(dsn='./CrimeWards_SHP','CrimeWards_2010',verbose=FALSE,stringsAsFactors=FALSE)\nshapeList[[7]] <- readOGR(dsn='./CrimeWards_SHP','CrimeWards_2011',verbose=FALSE,stringsAsFactors=FALSE)\nshapeList[[8]] <- readOGR(dsn='./CrimeWards_SHP','CrimeWards_2012',verbose=FALSE,stringsAsFactors=FALSE)\nshapeList[[9]] <- readOGR(dsn='./CrimeWards_SHP','CrimeWards_2013',verbose=FALSE,stringsAsFactors=FALSE)\n\nprj.LatLong <- CRS(\"+proj=longlat +ellps=WGS84 +datum=WGS84\")\n\nfor (x in 1:9){\n    shapeList[[x]] <- spTransform(shapeList[[x]], prj.LatLong)\n}\n\nlocation<-c(-75.67724,45.29814)\nfactpal <- colorNumeric(rev(heat.colors(3)), domain = NULL)\n\ngetPoly <- function(theY,theCC,theStat) {\n        theYear<-as.integer(theY)\n        if (theCC == \"total\") {\n        if (theStat == \"total\") {\n            theDF<-theCrime[theCrime$year == theYear,c(\"Ward_Number\",\"ward_Name\",\"population\",\"total_num\")]\n        }\n        else if(theStat==\"solv\"){\n            theDF<-theCrime[theCrime$year == theYear,c(\"Ward_Number\",\"ward_Name\",\"population\",\"total_solv\")]\n        }\n        else {\n            theDF<-theCrime[theCrime$year == theYear,c(\"Ward_Number\",\"ward_Name\",\"population\",\"total_rate\")]\n        }\n    }\n    else if (theCC == \"person\") {\n            if (theStat == \"total\") {\n                theDF<-theCrime[theCrime$year == theYear,c(\"Ward_Number\",\"ward_Name\",\"population\",\"viol_num\")]\n            }\n            else if(theStat==\"solv\"){\n                theDF<-theCrime[theCrime$year == theYear,c(\"Ward_Number\",\"ward_Name\",\"population\",\"viol_solv\")]\n            }\n            else {\n                theDF<-theCrime[theCrime$year == theYear,c(\"Ward_Number\",\"ward_Name\",\"population\",\"viol_rate\")]\n            }\n        } \n    else if (theCC == \"prop\") {\n            if (theStat == \"total\") {\n                theDF<-theCrime[theCrime$year == theYear,c(\"Ward_Number\",\"ward_Name\",\"population\",\"prop_num\")]\n            }\n            else if(theStat==\"solv\"){\n                theDF<-theCrime[theCrime$year == theYear,c(\"Ward_Number\",\"ward_Name\",\"population\",\"prop_solv\")]\n            }\n            else {\n                theDF<-theCrime[theCrime$year == theYear,c(\"Ward_Number\",\"ward_Name\",\"population\",\"prop_rate\")]\n            }\n        } \n    else if (theCC == \"traffic\") {\n            if (theStat == \"total\") {\n                theDF<-theCrime[theCrime$year == theYear,c(\"Ward_Number\",\"ward_Name\",\"population\",\"traff_num\")]\n            }\n            else if(theStat==\"solv\"){\n                theDF<-theCrime[theCrime$year == theYear,c(\"Ward_Number\",\"ward_Name\",\"population\",\"traff_solv\")]\n            }\n            else {\n                theDF<-theCrime[theCrime$year == theYear,c(\"Ward_Number\",\"ward_Name\",\"population\",\"traff_rate\")]\n            }\n        } \n        else {\n            if (theStat == \"total\") {\n                theDF<-theCrime[theCrime$year == theYear,c(\"Ward_Number\",\"ward_Name\",\"population\",\"occo_num\")]\n            }\n            else if(theStat==\"solv\"){\n                theDF<-theCrime[theCrime$year == theYear,c(\"Ward_Number\",\"ward_Name\",\"population\",\"occo_solv\")]\n            }\n            else {\n                theDF<-theCrime[theCrime$year == theYear,c(\"Ward_Number\",\"ward_Name\",\"population\",\"occo_rate\")]\n            }\n        }\n    \n    theDF<-na.omit(theDF)\n    if (nrow(theDF)==0){return(NULL)}\n    \n    names(theDF)[4]<-\"theNum\"\n    wardPoly<-shapeList[[(theYear-2004)]]\n    wardPoly@data$numAmt <- 0\n    if (theYear == 2013){\n        for (ward in theDF$Ward_Number) {\n            wardString<-paste0(\"Ward \",ward)\n            wardPoly@data$numAmt[wardPoly@data$W_NUMBER==wardString]<-theDF$theNum[theDF$Ward_Number==ward]\n        }\n    }\n    else {\n        for (ward in theDF$Ward_Number) {\n            wardPoly@data$numAmt[wardPoly@data$WARD_NUM==ward]<-theDF$theNum[theDF$Ward_Number==ward]\n        }\n    }\n\n    if (theYear == 2013) {\n        theDF$Ward_Number<-paste0(\"Ward \",theDF$Ward_Number)\n        wp<-wardPoly[wardPoly@data$W_NUMBER %in% theDF$Ward_Number,]\n    }\n    else {\n        wp<-wardPoly[wardPoly@data$WARD_NUM %in% theDF$Ward_Number,]\n    }\n    return(wp)\n}\n\nthePoly <-getPoly(2013,\"total\",\"total\")",
    "created" : 1440684760064.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2436933403",
    "id" : "80844F1B",
    "lastKnownWriteTime" : 1475094213,
    "last_content_update" : 1475094213372,
    "path" : "~/Documents/ODOttawa/Crime_Statistics/CrimeOttawa/global.R",
    "project_path" : "global.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 0,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}